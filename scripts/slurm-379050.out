ls: cannot access '/net/projects/fermi-gnn/24autumn/meghane/winter_dsi_final/checkpoints': No such file or directory
/net/projects/fermi-gnn/24autumn/meghane/winter_dsi_final/checkpoints
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
You are using a CUDA device ('NVIDIA A40') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
wandb: Using wandb-core as the SDK backend.  Please refer to https://wandb.me/wandb-core for more information.
wandb: Currently logged in as: mesaidenberg (mesaidenberg-university-of-chicago). Use `wandb login --relogin` to force relogin
wandb: Tracking run with wandb version 0.18.7
wandb: Run data is saved locally in /net/projects/fermi-gnn/24autumn/meghane/winter_dsi_final/2024-autumn-nugraph/checkpoints/pmt/wandb/run-20250227_211843-24.7.1
wandb: Run `wandb offline` to turn off syncing.
wandb: Resuming run pmt
wandb: ‚≠êÔ∏è View project at https://wandb.ai/mesaidenberg-university-of-chicago/nugraph
wandb: üöÄ View run at https://wandb.ai/mesaidenberg-university-of-chicago/nugraph/runs/24.7.1
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
Loading `train_dataloader` to estimate number of stepping batches.

  | Name             | Type            | Params | Mode 
-------------------------------------------------------------
0 | encoder          | Encoder         | 2.5 K  | train
1 | core_net         | NuGraphCore     | 193 K  | train
2 | event_decoder    | EventDecoder    | 133    | train
3 | semantic_decoder | SemanticDecoder | 646    | train
4 | filter_decoder   | FilterDecoder   | 130    | train
5 | vertex_decoder   | VertexDecoder   | 100    | train
6 | instance_decoder | InstanceDecoder | 4.3 K  | train
-------------------------------------------------------------
201 K     Trainable params
0         Non-trainable params
201 K     Total params
0.806     Total estimated model params size (MB)
164       Modules in train mode
0         Modules in eval mode
SLURM auto-requeueing enabled. Setting signal handlers.

configuring nugraph environment:
  NUGRAPH_DIR   (set from env var)  - /net/projects/fermi-gnn/24autumn/meghane/winter_dsi_final/2024-autumn-nugraph/scripts/train.py
  NUGRAPH_DATA  (set from env var)  - /net/projects/fermi-gnn/24summer/helal/preprocessing3/graph.h5
  NUGRAPH_LOG   (set from env var)  - /net/projects/fermi-gnn/24autumn/meghane/winter_dsi_final/2024-autumn-nugraph/checkpoints

Traceback (most recent call last):
  File "/net/projects/fermi-gnn/24autumn/meghane/winter_dsi_final/2024-autumn-nugraph/scripts/train.py", line 85, in <module>
    train(args)
  File "/net/projects/fermi-gnn/24autumn/meghane/winter_dsi_final/2024-autumn-nugraph/scripts/train.py", line 80, in train
    trainer.fit(model, datamodule=nudata)
  File "/home/msaidenberg/.conda/envs/justin_gnn/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 538, in fit
    call._call_and_handle_interrupt(
  File "/home/msaidenberg/.conda/envs/justin_gnn/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py", line 47, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/msaidenberg/.conda/envs/justin_gnn/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 574, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "/home/msaidenberg/.conda/envs/justin_gnn/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 981, in _run
    results = self._run_stage()
  File "/home/msaidenberg/.conda/envs/justin_gnn/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 1023, in _run_stage
    self._run_sanity_check()
  File "/home/msaidenberg/.conda/envs/justin_gnn/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 1052, in _run_sanity_check
    val_loop.run()
  File "/home/msaidenberg/.conda/envs/justin_gnn/lib/python3.10/site-packages/pytorch_lightning/loops/utilities.py", line 178, in _decorator
    return loop_run(self, *args, **kwargs)
  File "/home/msaidenberg/.conda/envs/justin_gnn/lib/python3.10/site-packages/pytorch_lightning/loops/evaluation_loop.py", line 128, in run
    batch, batch_idx, dataloader_idx = next(data_fetcher)
  File "/home/msaidenberg/.conda/envs/justin_gnn/lib/python3.10/site-packages/pytorch_lightning/loops/fetchers.py", line 133, in __next__
    batch = super().__next__()
  File "/home/msaidenberg/.conda/envs/justin_gnn/lib/python3.10/site-packages/pytorch_lightning/loops/fetchers.py", line 60, in __next__
    batch = next(self.iterator)
  File "/home/msaidenberg/.conda/envs/justin_gnn/lib/python3.10/site-packages/pytorch_lightning/utilities/combined_loader.py", line 341, in __next__
    out = next(self._iterator)
  File "/home/msaidenberg/.conda/envs/justin_gnn/lib/python3.10/site-packages/pytorch_lightning/utilities/combined_loader.py", line 142, in __next__
    out = next(self.iterators[0])
  File "/home/msaidenberg/.conda/envs/justin_gnn/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 630, in __next__
    data = self._next_data()
  File "/home/msaidenberg/.conda/envs/justin_gnn/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 673, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "/home/msaidenberg/.conda/envs/justin_gnn/lib/python3.10/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/msaidenberg/.conda/envs/justin_gnn/lib/python3.10/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/msaidenberg/.conda/envs/justin_gnn/lib/python3.10/site-packages/torch_geometric/data/dataset.py", line 292, in __getitem__
    data = data if self.transform is None else self.transform(data)
  File "/home/msaidenberg/.conda/envs/justin_gnn/lib/python3.10/site-packages/torch_geometric/transforms/base_transform.py", line 32, in __call__
    return self.forward(copy.copy(data))
  File "/home/msaidenberg/.conda/envs/justin_gnn/lib/python3.10/site-packages/torch_geometric/transforms/compose.py", line 24, in forward
    data = transform(data)
  File "/net/projects/fermi-gnn/24autumn/meghane/winter_dsi_final/2024-autumn-nugraph/nugraph/nugraph/util/hierarchical_edges.py", line 92, in __call__
    lo, hi = data["sp", "nexus_optical", "opflashsumpe"].edge_index
  File "/home/msaidenberg/.conda/envs/justin_gnn/lib/python3.10/site-packages/torch_geometric/data/storage.py", line 96, in __getattr__
    raise AttributeError(
AttributeError: 'EdgeStorage' object has no attribute 'edge_index'
Traceback (most recent call last):
  File "/net/projects/fermi-gnn/24autumn/meghane/winter_dsi_final/2024-autumn-nugraph/scripts/train.py", line 85, in <module>
    train(args)
  File "/net/projects/fermi-gnn/24autumn/meghane/winter_dsi_final/2024-autumn-nugraph/scripts/train.py", line 80, in train
    trainer.fit(model, datamodule=nudata)
  File "/home/msaidenberg/.conda/envs/justin_gnn/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 538, in fit
    call._call_and_handle_interrupt(
  File "/home/msaidenberg/.conda/envs/justin_gnn/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py", line 47, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/msaidenberg/.conda/envs/justin_gnn/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 574, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "/home/msaidenberg/.conda/envs/justin_gnn/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 981, in _run
    results = self._run_stage()
  File "/home/msaidenberg/.conda/envs/justin_gnn/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 1023, in _run_stage
    self._run_sanity_check()
  File "/home/msaidenberg/.conda/envs/justin_gnn/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 1052, in _run_sanity_check
    val_loop.run()
  File "/home/msaidenberg/.conda/envs/justin_gnn/lib/python3.10/site-packages/pytorch_lightning/loops/utilities.py", line 178, in _decorator
    return loop_run(self, *args, **kwargs)
  File "/home/msaidenberg/.conda/envs/justin_gnn/lib/python3.10/site-packages/pytorch_lightning/loops/evaluation_loop.py", line 128, in run
    batch, batch_idx, dataloader_idx = next(data_fetcher)
  File "/home/msaidenberg/.conda/envs/justin_gnn/lib/python3.10/site-packages/pytorch_lightning/loops/fetchers.py", line 133, in __next__
    batch = super().__next__()
  File "/home/msaidenberg/.conda/envs/justin_gnn/lib/python3.10/site-packages/pytorch_lightning/loops/fetchers.py", line 60, in __next__
    batch = next(self.iterator)
  File "/home/msaidenberg/.conda/envs/justin_gnn/lib/python3.10/site-packages/pytorch_lightning/utilities/combined_loader.py", line 341, in __next__
    out = next(self._iterator)
  File "/home/msaidenberg/.conda/envs/justin_gnn/lib/python3.10/site-packages/pytorch_lightning/utilities/combined_loader.py", line 142, in __next__
    out = next(self.iterators[0])
  File "/home/msaidenberg/.conda/envs/justin_gnn/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 630, in __next__
    data = self._next_data()
  File "/home/msaidenberg/.conda/envs/justin_gnn/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 673, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "/home/msaidenberg/.conda/envs/justin_gnn/lib/python3.10/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/msaidenberg/.conda/envs/justin_gnn/lib/python3.10/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/msaidenberg/.conda/envs/justin_gnn/lib/python3.10/site-packages/torch_geometric/data/dataset.py", line 292, in __getitem__
    data = data if self.transform is None else self.transform(data)
  File "/home/msaidenberg/.conda/envs/justin_gnn/lib/python3.10/site-packages/torch_geometric/transforms/base_transform.py", line 32, in __call__
    return self.forward(copy.copy(data))
  File "/home/msaidenberg/.conda/envs/justin_gnn/lib/python3.10/site-packages/torch_geometric/transforms/compose.py", line 24, in forward
    data = transform(data)
  File "/net/projects/fermi-gnn/24autumn/meghane/winter_dsi_final/2024-autumn-nugraph/nugraph/nugraph/util/hierarchical_edges.py", line 92, in __call__
    lo, hi = data["sp", "nexus_optical", "opflashsumpe"].edge_index
  File "/home/msaidenberg/.conda/envs/justin_gnn/lib/python3.10/site-packages/torch_geometric/data/storage.py", line 96, in __getattr__
    raise AttributeError(
AttributeError: 'EdgeStorage' object has no attribute 'edge_index'
Sanity Checking: |          | 0/? [00:00<?, ?it/s][1;34mwandb[0m: üöÄ View run [33mpmt[0m at: [34mhttps://wandb.ai/mesaidenberg-university-of-chicago/nugraph/runs/24.7.1[0m
[1;34mwandb[0m: Find logs at: [1;35m../checkpoints/pmt/wandb/run-20250227_211843-24.7.1/logs[0m
srun: error: g007: task 0: Exited with exit code 1
